#pragma rtGlobals=1		// Use modern global access method.Menu "GL"	"Do It All Waves", DoItAllWaves()EndFunction DoItAllWaves()		String WaveNameFormat=StrVarOrDefault("root:GL_Globals:DoItAll:GWaveNameFormat", "PMP*")	String FunctionNameString=StrVarOrDefault("root:GL_Globals:DoItAll:GFunctionNameString", "")	String EDate=""	String CS=""	Prompt WaveNameFormat, "Please specify the wave name format:"	Prompt EDate, "Please specify the date on which this experiment was performed (format: 9.03.15)"	Prompt CS "Please specify \"Spont\" or \"Current\""	Prompt FunctionNameString, "Please specify the function name:", popup, FunctionList("*_batch",";","")	DoPrompt "Do It All Waves", WaveNameFormat, EDate, CS, FunctionNameString	String/G ExpDate = EDate	String/G cc_or_spont = CS	if (V_flag==1)		Abort	endif	NewDataFolder/O root:GL_Globals	NewDataFolder/O root:GL_Globals:DoItAll	String/G root:GL_Globals:DoItAll:GWaveNameFormat=WaveNameFormat	String/G root:GL_Globals:DoItAll:GFunctionNameString=FunctionNameString			String AllWaveNameList=WaveList(WaveNameFormat,";","")		if (strlen(AllWaveNameList)==0)		Print "No specified waves are found in current folder!"		Abort	endif		String WaveNameString=""	Make/D/O/N=0 Results	Make/T/O/N=0 WaveNamesAll	Variable i=0	FUNCREF myprotofunc f=$FunctionNameString	Do 		WaveNameString=StringFromList(i, AllWaveNameList)		InsertPoints numpnts(Results), 1, Results		Results[numpnts(Results)-1]=f($WaveNameString)		InsertPoints numpnts(WaveNamesAll), 1, WaveNamesAll		WaveNamesAll[numpnts(WaveNamesAll)-1]=WaveNameString				i=i+1	While (strlen(StringFromList(i, AllWaveNameList))!=0)	String ResultsWaveString="r_"+FunctionNameString	WaveStats/Q/Z Results	//Print V_avg, V_sdev	Duplicate/O Results, $ResultsWaveString	ResultsWaveString="WaveName_"+FunctionNameString	Duplicate/O WaveNamesAll, $ResultsWaveString	KillWaves/Z Results, WaveNamesAllEndFunction myprotofunc(w)	Wave w	Print "No function found."EndFunction RenameWave_batch(w)	Wave w	String WaveNameString=NameOfWave(w)		SVAR ExpDate = root:ExpDate	SVAR cc_or_spont = root:cc_or_spont		if(stringmatch(cc_or_spont, "Current"))		String NameString= ExpDate + ".Cell1."		//9.03.15.Cell1.			String step = num2str(str2num(StringFromList(3, WaveNameString, "_"))*10-60) + "pa"		NameString=NameString + step		//9.03.15.Cell1.-50pa			NameString=NameString+".r"+num2str(ceil(.5 * str2num(StringFromList(2, WaveNameString, "_"))))		//9.03.15.Cell1.-50pa.r1			//NameString=NameString+"_"	//NameString=NameString+StringFromList(3, WaveNameString, "_")	//NameString=NameString+"_"//NameString=NameString+StringFromList(4, WaveNameString, "_")		Rename w, $NameString	elseif(stringmatch(cc_or_spont, "Spont"))		String NString= ExpDate + ".Cell1.Spont1"		NString=NString+".r"+num2str(ceil(.5 * str2num(StringFromList(2, WaveNameString, "_"))))					Rename w, $NString	else		Print "Must input either \"Spont\" or \"Current\""		Abort	endif	End